<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>ã€å¾Œå°ã€‘è’¼è²“æ¨¡å‹æ‡¸è³åå–®ç®¡ç†</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@900&display=swap');
        body { 
            font-family: 'Noto Sans TC', sans-serif; background-color: #1a1a1a; 
            background-size: cover; background-position: center; background-attachment: fixed;
            display: flex; flex-direction: column; align-items: center; color: #f1f1f1; margin: 0; padding: 20px;
        }
        h1 { font-size: 50px; color: #ffcc33; filter: drop-shadow(2px 2px 0px #000); }
        
        #poster-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; }
        .poster-wrapper { position: relative; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 10px; }

        /* æ‡¸è³ä»¤ç¸®åœ–æ¨£å¼ */
        .wanted-poster {
            width: 280px; background-color: #dfc9a5; background-image: url('https://www.transparenttextures.com/patterns/papyros.png');
            padding: 20px; color: #3e2723; text-align: center; border: 1px solid #bc9b6a; position: relative;
        }
        .photo-area { width: 100%; height: 180px; border: 4px solid #3e2723; overflow: hidden; position: relative; background: #eee; }
        .photo-area img { width: 100%; height: 100%; object-fit: cover; position: absolute; }
        
        /* æ§åˆ¶æŒ‰éˆ• */
        .controls { background: rgba(30, 30, 30, 0.95); padding: 25px; border-radius: 20px; margin-top: 40px; width: 400px; border: 2px solid #ffcc33; }
        input { width: 100%; margin-bottom: 15px; padding: 10px; border-radius: 5px; border: 1px solid #444; background: #000; color: white; box-sizing: border-box; }
        .main-btn { width: 100%; padding: 15px; background: #e67e22; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-bottom: 10px; }
        .sync-btn { width: 100%; padding: 15px; background: #27ae60; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .delete-btn { position: absolute; top: -10px; right: -10px; background: red; color: white; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; border: 2px solid white; }
        
        .move-row { display: flex; justify-content: center; gap: 5px; margin-top: 5px; }
        .btn-move { background: #444; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>

    <h1>æ‡¸è³åå–®ç®¡ç†å¾Œå°</h1>

    <div id="poster-container"></div>

    <div class="controls">
        <label>ğŸ–¼ï¸ ç¶²é å¤§èƒŒæ™¯åœ–é€£çµ (URL)</label>
        <input type="text" id="bgUrlInput" placeholder="è«‹è²¼ä¸Šåœ–ç‰‡ç¶²å€" onchange="updateBg(this.value)">

        <label>ç¨±è™Ÿ / ç½ªå</label>
        <input type="text" id="crimeInput" placeholder="æœ€å¼·åŠå£«">
        
        <label>å°è±¡åç¨±</label>
        <input type="text" id="nameInput" placeholder="ç¾…ç¾…äºÂ·ç´¢éš†">
        
        <label>é‡‘é¡</label>
        <input type="number" id="bountyInput" placeholder="30000000">
        
        <label>ğŸ‘¤ äººç‰©ç…§ç‰‡é€£çµ (URL)</label>
        <input type="text" id="imgUrlInput" placeholder="è«‹è²¼ä¸Šåœ–ç‰‡ç¶²å€">
        
        <button class="main-btn" onclick="addPoster()">æ–°å¢æ‡¸è³ä»¤</button>
        <button class="sync-btn" onclick="syncToGitHub()">ğŸš€ ç™¼ä½ˆæ›´æ–°åˆ°å‰å°</button>
        <p id="status" style="text-align:center; font-size:12px; color:#ffcc33;"></p>
    </div>

    <script>
        let postersData = [];
        let config = {
            token: "YOUR_GITHUB_TOKEN", // æ›¿æ›ä½ çš„ Token
            user: "YOUR_USERNAME",       // æ›¿æ›ä½ çš„ GitHub å¸³è™Ÿ
            repo: "YOUR_REPO_NAME",      // æ›¿æ›ä½ çš„ Repository åç¨±
            bg: ""
        };

        function updateBg(url) {
            config.bg = url;
            document.body.style.backgroundImage = `url(${url})`;
        }

        function addPoster() {
            const data = {
                id: Date.now(),
                crime: document.getElementById('crimeInput').value || "æœªçŸ¥ç½ªå",
                name: document.getElementById('nameInput').value || "UNKNOWN",
                bounty: "à¸¿ " + Number(document.getElementById('bountyInput').value).toLocaleString() + "-",
                img: document.getElementById('imgUrlInput').value || "https://via.placeholder.com/270x200",
                top: "0px",
                left: "0px"
            };
            postersData.push(data);
            render();
        }

        function render() {
            const container = document.getElementById('poster-container');
            container.innerHTML = "";
            postersData.forEach((p, index) => {
                const div = document.createElement('div');
                div.className = "poster-wrapper";
                div.innerHTML = `
                    <button class="delete-btn" onclick="removePoster(${index})">X</button>
                    <div class="wanted-poster">
                        <div style="font-size:40px; font-family:Impact;">WANTED</div>
                        <div class="photo-area"><img src="${p.img}" style="top:${p.top}; left:${p.left}; transform:scale(1.2);"></div>
                        <div style="font-size:12px; margin:5px 0;">DEAD OR ALIVE</div>
                        <div style="font-weight:bold;">${p.crime}</div>
                        <div style="font-size:24px; font-family:Impact;">${p.name}</div>
                        <div style="font-size:16px; font-family:Impact;">${p.bounty}</div>
                    </div>
                    <div class="move-row">
                        <button class="btn-move" onclick="moveImg(${index},'up')">â†‘</button>
                    </div>
                    <div class="move-row">
                        <button class="btn-move" onclick="moveImg(${index},'left')">â†</button>
                        <button class="btn-move" onclick="moveImg(${index},'down')">â†“</button>
                        <button class="btn-move" onclick="moveImg(${index},'right')">â†’</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function moveImg(index, dir) {
            let p = postersData[index];
            let t = parseInt(p.top) || 0;
            let l = parseInt(p.left) || 0;
            if(dir==='up') t-=10; if(dir==='down') t+=10;
            if(dir==='left') l-=10; if(dir==='right') l+=10;
            p.top = t+"px"; p.left = l+"px";
            render();
        }

        function removePoster(index) { postersData.splice(index, 1); render(); }

        async function syncToGitHub() {
            const status = document.getElementById('status');
            status.innerText = "åŒæ­¥ä¸­...";
            
            const fileName = "data.json";
            const content = btoa(unescape(encodeURIComponent(JSON.stringify({ bg: config.bg, posters: postersData }))));
            const url = `https://api.github.com/repos/${config.user}/${config.repo}/contents/${fileName}`;

            try {
                // ç²å–ç›®å‰çš„æª”æ¡ˆ SHA (æ›´æ–°å¿…éœ€)
                const res = await fetch(url, { headers: { "Authorization": `token ${config.token}` } });
                let sha = "";
                if (res.ok) { const json = await res.json(); sha = json.sha; }

                // ä¸Šå‚³æ–°æª”æ¡ˆ
                const putRes = await fetch(url, {
                    method: "PUT",
                    headers: { "Authorization": `token ${config.token}`, "Content-Type": "application/json" },
                    body: JSON.stringify({ message: "Update Data", content: content, sha: sha })
                });

                if (putRes.ok) status.innerText = "âœ… åŒæ­¥æˆåŠŸï¼å‰å°ç´„ 1 åˆ†é˜å¾Œæ›´æ–°ã€‚";
                else status.innerText = "âŒ åŒæ­¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Token æˆ– Repo è¨­å®šã€‚";
            } catch (e) { status.innerText = "âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š" + e.message; }
        }
    </script>
</body>
</html>